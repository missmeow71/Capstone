{"ast":null,"code":"import _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime-corejs2/helpers/esm/objectWithoutProperties\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/missmeow/Documents/Capstone/personafi/pages/cart.js\";\nimport React from \"react\";\nimport Layout from '../components/Layout';\nimport CartItemList from '../components/CartItemList';\nimport CartSummary from '../components/CartSummary';\nimport { getCartItems, removeFromCart, checkoutCart, payForOrder } from '../lib/moltin';\n\nvar Cart =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Cart, _React$Component);\n\n  function Cart() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Cart);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Cart)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      items: [],\n      loading: true,\n      completed: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"_handleCheckout\",\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(data) {\n        var cartId, token, email, _data$card, name, line_1, city, country, county, postcode, customer, address, _ref2, id;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return localStorage.getItem('mcart');\n\n              case 2:\n                cartId = _context.sent;\n                token = data.id, email = data.email, _data$card = data.card, name = _data$card.name, line_1 = _data$card.address_line1, city = _data$card.adress_city, country = _data$card.address_country, county = _data$card.address_state, postcode = _data$card.address_zip;\n                customer = {\n                  name: name,\n                  email: email\n                };\n                address = {\n                  first_name: name.split(' ')[0],\n                  last_name: name.split(' ')[1],\n                  line_1: line_1,\n                  city: city,\n                  county: county,\n                  country: country,\n                  postcode: postcode\n                };\n                _context.prev = 6;\n                _context.next = 9;\n                return checkoutCart(cartId, customer, address);\n\n              case 9:\n                _ref2 = _context.sent;\n                id = _ref2.data.id;\n                _context.next = 13;\n                return payForOrder(id, token, email);\n\n              case 13:\n                _this.setState({\n                  completed: true\n                });\n\n                _context.next = 19;\n                break;\n\n              case 16:\n                _context.prev = 16;\n                _context.t0 = _context[\"catch\"](6);\n                console.log(_context.t0);\n\n              case 19:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[6, 16]]);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n\n    _defineProperty(_assertThisInitialized(_this), \"_handleRemoveFromCart\",\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(itemId) {\n        var cartId, _ref4, data, meta;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                cartId = _this.state.cartId;\n                _context2.next = 3;\n                return removeFromCart(itemId, cartId);\n\n              case 3:\n                _ref4 = _context2.sent;\n                data = _ref4.data;\n                meta = _ref4.meta;\n\n                _this.setState({\n                  items: data,\n                  meta: meta\n                });\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x2) {\n        return _ref3.apply(this, arguments);\n      };\n    }());\n\n    return _this;\n  }\n\n  _createClass(Cart, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3() {\n        var cartId, _ref5, data, meta;\n\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return localStorage.getItem('mcart');\n\n              case 2:\n                cartId = _context3.sent;\n                _context3.next = 5;\n                return getCartItems(cartId);\n\n              case 5:\n                _ref5 = _context3.sent;\n                data = _ref5.data;\n                meta = _ref5.meta;\n                this.setState({\n                  items: data,\n                  meta: meta,\n                  cartId: cartId,\n                  loading: false\n                });\n\n              case 9:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          meta = _this$state.meta,\n          rest = _objectWithoutProperties(_this$state, [\"meta\"]);\n\n      var loading = rest.loading;\n      return React.createElement(Layout, {\n        title: \"Cart\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85\n        },\n        __self: this\n      }, React.createElement(CartItemList, _extends({}, rest, {\n        removeFromCart: this._handleRemoveFromCart,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      })), !loading && !rest.completed && React.createElement(CartSummary, _extends({}, meta, {\n        handleCheckout: this._handleCheckout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return Cart;\n}(React.Component);\n\nexport { Cart as default };","map":{"version":3,"sources":["/Users/missmeow/Documents/Capstone/personafi/pages/cart.js"],"names":["Layout","CartItemList","CartSummary","getCartItems","removeFromCart","checkoutCart","payForOrder","Cart","items","loading","completed","data","localStorage","getItem","cartId","token","id","email","card","name","line_1","address_line1","city","adress_city","country","address_country","county","address_state","postcode","address_zip","customer","address","first_name","split","last_name","setState","console","log","itemId","state","meta","rest","_handleRemoveFromCart","_handleCheckout","React","Component"],"mappings":"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","sourcesContent":["import Layout from '../components/Layout'\nimport CartItemList from '../components/CartItemList'\nimport CartSummary from '../components/CartSummary'\nimport { getCartItems, removeFromCart, checkoutCart, payForOrder } from '../lib/moltin'\n\n\n\nexport default class Cart extends React.Component {\n  state = {\n    items: [],\n    loading: true,\n    completed: false\n  }\n\n  async componentDidMount() {\n    const cartId = await localStorage.getItem('mcart')\n    const {data, meta} = await getCartItems(cartId)\n\n    this.setState({\n      items: data,\n      meta,\n      cartId,\n      loading: false\n    })\n  }\n\n_handleCheckout = async data => {\n  const cartId = await localStorage.getItem('mcart')\n\n  const {\n    id: token,\n    email,\n    card: {\n      name,\n      address_line1: line_1,\n      adress_city: city,\n      address_country: country,\n      address_state: county,\n      address_zip: postcode\n    }\n  } = data\n\n  const customer = {\n    name,\n    email\n  }\n\n  const address = {\n        first_name: name.split(' ')[0],\n        last_name: name.split(' ')[1],\n        line_1,\n        city,\n        county,\n        country,\n        postcode\n  }\n\n  try{\n    const {data: {id}} = await checkoutCart(cartId, customer, address)\n\n    await payForOrder(id, token, email)\n\n    this.setState({\n      completed: true\n    })\n  } catch (e) {\n    console.log(e);\n  }\n}\n  _handleRemoveFromCart = async itemId => {\n    const {cartId} = this.state\n    const {data, meta} = await removeFromCart(itemId, cartId)\n\n    this.setState({\n      items: data,\n      meta\n    })\n  }\n\n  render() {\n    const {meta, ...rest} = this.state\n    const {loading} = rest\n\n    return (\n      <Layout title='Cart'>\n        <CartItemList {...rest} removeFromCart={this._handleRemoveFromCart} />\n        {!loading &&\n          !rest.completed && (\n          <CartSummary {...meta} handleCheckout={this._handleCheckout} />\n        )}\n      </Layout>\n\n    )\n\n  }\n}"]},"metadata":{},"sourceType":"module"}