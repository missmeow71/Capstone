{"version":3,"file":"6.c5bfd977e7744fa13164.hot-update.js","sources":["webpack:///lib/moltin.js","webpack:///pages/cart.js"],"sourcesContent":["import { gateway as MoltinGateway } from '@moltin/sdk'\n\nconst Moltin = MoltinGateway({\n    client_id: 'TkrDPNqfC1j7AJFFUHnMZbN9RzPygkff3beqMhxQsl'\n})\n\nexport const getProducts = () => Moltin.Products.With('main_image').All()\n\nexport const getProductById = id => Moltin.Products.With('main_image').Get(id)\n\nexport const addToCart = (productId, quantity) => Moltin.Cart().AddProduct(productId, quantity)\n\nexport const getCartItems = id => Moltin.Cart(id).Items()\n\nexport const removeFromCart = (itemId, cartId) => Moltin.Cart(cartId).RemoveItem(itemId)\n\nexport const checkoutCart = (cartId, customer, billing) => Moltin.Cart(cartId).Checkout(customer, billing)\n\n\n// WEBPACK FOOTER //\n// lib/moltin.js","import Layout from '../components/Layout'\nimport CartItemList from '../components/CartItemList'\nimport CartSummary from '../components/CartSummary'\nimport { getCartItems, removeFromCart, checkoutCart, payForOrder } from '../lib/moltin'\n\n\n\nexport default class Cart extends React.Component {\n  state = {\n    items: [],\n    loading: true,\n    completed: false\n  }\n\n  async componentDidMount() {\n    const cartId = await localStorage.getItem('mcart')\n    const {data, meta} = await getCartItems(cartId)\n\n    this.setState({\n      items: data,\n      meta,\n      cartId,\n      loading: false\n    })\n  }\n\n_handleCheckout = async data => {\n  const cartId = await localStorage.getItem('mcart')\n\n  const {\n    id: token,\n    email,\n    card: {\n      name,\n      address_line1: line_1,\n      adress_city: city,\n      address_country: country,\n      address_state: county,\n      address_zip: postcode\n    }\n  } = data\n\n  const customer = {\n    name,\n    email\n  }\n\n  const address = {\n        first_name: name.split(' ')[0],\n        last_name: name.split(' ')[1],\n        line_1,\n        city,\n        county,\n        country,\n        postcode\n  }\n\n  try{\n    const {data: {id}} = await checkoutCart(cartId, customer, address)\n\n    await payForOrder(id, token, email)\n\n    this.setState({\n      completed: true\n    })\n  } catch (e) {\n    console.log(e);\n  }\n}\n  _handleRemoveFromCart = async itemId => {\n    const {cartId} = this.state\n    const {data, meta} = await removeFromCart(itemId, cartId)\n\n    this.setState({\n      items: data,\n      meta\n    })\n  }\n\n  render() {\n    const {meta, ...rest} = this.state\n    const {loading} = rest\n\n    return (\n      <Layout title='Cart'>\n        <CartItemList {...rest} removeFromCart={this._handleRemoveFromCart} />\n        {!loading &&\n          !rest.completed && (\n          <CartSummary {...meta} handleCheckout={this._handleCheckout} />\n        )}\n      </Layout>\n\n    )\n\n  }\n}\n\n\n// WEBPACK FOOTER //\n// pages/cart.js"],"mappings":";;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AADA;AAIA;AAAA;AAAA;AAEA;AAAA;AAAA;AAEA;AAAA;AAAA;AAEA;AAAA;AAAA;AAEA;AAAA;AAAA;AAEA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChBA;AACA;AACA;AACA;AACA;AAGA;;;;;;;;;;;;;;;;;;;;AACA;AACA;AACA;AACA;AAHA;;;;;;;;AAkBA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AAGA;AAYA;AACA;AACA;AAFA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AArBA;AAAA;AAAA;AACA;AADA;AAAA;AAgCA;AAhCA;AAAA;AACA;AADA;AAoCA;AACA;AADA;AACA;AArCA;AAAA;AACA;AADA;AAAA;AAAA;AAwCA;AACA;AAzCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;;AA0CA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAEA;AAAA;AACA;AACA;AACA;AACA;AAFA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;;;;;;;;;;;AAvDA;AACA;;AADA;;AACA;AACA;;;AADA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAJA;AACA;;;;;;;;;;;;;;;AA4DA;AAAA;AAAA;AAAA;AACA;AADA;AAIA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;;;;AAvFA;AACA;AADA;;;;;;;;;;;;;;;;;;;;;;;A","sourceRoot":""}