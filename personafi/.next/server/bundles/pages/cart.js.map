{"version":3,"file":"bundles/pages/cart.js","sources":["webpack:///webpack/bootstrap 1fab4c01b4dc182988c7","webpack:///components/CartItemList.js","webpack:///components/CartSummary.js","webpack:///components/Header.js","webpack:///components/Layout.js","webpack:///lib/moltin.js","webpack:///pages/cart.js","webpack:///external \"@babel/runtime/regenerator\"","webpack:///external \"@moltin/sdk\"","webpack:///external \"next/head\"","webpack:///external \"next/link\"","webpack:///external \"next/router\"","webpack:///external \"nprogress\"","webpack:///external \"react\"","webpack:///external \"react-stripe-checkout\"","webpack:///external \"semantic-ui-react\""],"sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tvar threw = true;\n \t\ttry {\n \t\t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n \t\t\tthrew = false;\n \t\t} finally {\n \t\t\tif(threw) delete installedModules[moduleId];\n \t\t}\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 1fab4c01b4dc182988c7","import Link from 'next/link'\nimport {Item, Loader, Button, Message} from 'semantic-ui-react'\n\nexport default ({items, removeFromCart, loading, completed}) => {\n  if (loading) return <Loader active inline ='centered' />\n\n  if (completed)\n      return (\n        <Message success>\n          <Message.Header>Order Placed!</Message.Header>\n          <p>Congratulations! Your order is on its way</p>\n        </Message>\n      )\n\n  if (items.length === 0) {\n    return (\n      <Message warning>\n        <Message.Header>Your cart is empty!</Message.Header>\n        <p>Please add some items to your cart before resuming checkout.</p>\n      </Message>\n    )\n  }\n  const mapCartItemsToItems = items =>\n  items.map(({id, product_id, name, quantity, meta}) => {\n    const price = meta.display_price.with_tax.unit.formatted || null\n\n    return {\n      childKey: id,\n      header: (\n        <Link href={`/product?id=${product_id}`} passHref>\n          <Item.Header as=\"a\">{name}</Item.Header>\n        </Link>\n      ),\n      meta: `${quantity}x ${price}`,\n      extra: (\n        <Button\n          basic\n          icon='remove'\n          floated='right'\n          onClick={() => removeFromCart(id)}\n        />\n      )\n    }\n  })\n\n  return <Item.Group divided items={mapCartItemsToItems(items)} />\n}\n\n\n// WEBPACK FOOTER //\n// components/CartItemList.js","import StripeCheckout from 'react-stripe-checkout'\nimport {Button, Segment, Divider} from 'semantic-ui-react'\n\nconst stripeKey = 'pk_test_UBWSVyq6rmqp2x0bEwVQiicn'\n\nexport default ({\n    handleCheckout,\n    display_price: {with_tax: {currency, amount, formatted}}}) => (\n        <React.Fragment>\n            <Divider />\n\n            <Segment clearing size='large'>\n            <strong>Sub Total:</strong> {formatted}\n            <StripeCheckout\n            name=\"Personafi Marketplace\"\n            amount={amount}\n            currency={currency}\n            stripeKey={stripeKey}\n            shippingAddress={false}\n            billingAddress={true}\n            zipCode={true}\n            token={handleCheckout}\n            reconfigureOnUpdate={false}\n            triggerEvent=\"onClick\"\n            >\n            <Button color='orange' floated='right'>\n            Check Out\n            </Button>\n            </StripeCheckout>\n            </Segment>\n        </React.Fragment>\n    )\n\n\n// WEBPACK FOOTER //\n// components/CartSummary.js","import Link from 'next/link'\nimport Head from 'next/head'\nimport Router from 'next/router'\nimport NProgress from 'nprogress'\nimport {Menu, Container, Image} from 'semantic-ui-react'\n\nRouter.onRouteChangeStart = url => NProgress.start()\nRouter.onRouteChangeComplete = url => NProgress.done()\nRouter.onRouteChangeError = url => NProgress.done()\n\nexport default () => (\n    <React.Fragment>\n    <Head>\n      <link rel='stylesheet' type='text/css' href='/static/nprogress.css' />\n    </Head>\n    <Menu inverted fixed=\"top\" size=\"huge\">\n    <Container text>\n    <Link href=\"/\" prefetch passHref>\n        <Menu.Item as ='a' header>\n    <Image\n        height= \"75\"\n        width= \"115\"\n        src=\"/static/logo-wht.png\"\n        style={{ marginRight: '.1em'}}\n        />\n        </Menu.Item>\n    </Link>\n\n\n    <Link href='/register' prefetch passHref>\n        <Menu.Item position='right' as='a' >\n            Sign Up\n        </Menu.Item>\n    </Link>\n\n     <Link href='/login' prefetch passHref>\n        <Menu.Item position='right' as='a' >\n            Sign In\n        </Menu.Item>\n      </Link>\n\n    \n\n    <Link href=\"/cart\" prefetch passHref>\n        <Menu.Item position='right' as='a' header>\n            Cart\n        </Menu.Item>\n    </Link>\n    </Container>\n    </Menu>\n    </React.Fragment>\n)\n\n\n// WEBPACK FOOTER //\n// components/Header.js","\nimport Head from 'next/head'\nimport {Container} from 'semantic-ui-react'\nimport Header from './Header'\nexport default ({children, title = ''}) => (\n  <React.Fragment>\n    <Head>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n          <meta charSet=\"utf-8\" />\n          <link rel=\"stylesheet\" href=\"//cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.2/semantic.min.css\"/>\n          <title>{title}</title>\n    </Head>\n\n    <Header />\n     {/* <style jsx global>{`\n      body { \n        background-image:  linear-gradient(\n        rgba(148, 143, 145, 0.20),\n        rgba(148, 143, 145, 0.20)\n        ),url('/static/spaceship-interior.jpg');\n        background-size: cover;\n        background-repeat: no-repeat;\n        background-attachment: fixed;\n        height: 100vh;  \n      }\n    `}</style> */}\n\n    <Container text style ={{paddingTop: '7em'}}>\n      {children}\n    </Container>\n  </React.Fragment>\n)\n\n\n// WEBPACK FOOTER //\n// components/Layout.js","import { gateway as MoltinGateway } from '@moltin/sdk'\n\nconst Moltin = MoltinGateway({\n    client_id: 'TkrDPNqfC1j7AJFFUHnMZbN9RzPygkff3beqMhxQsl'\n})\n\nexport const getProducts = () => Moltin.Products.With('main_image').All()\n\nexport const getProductById = id => Moltin.Products.With('main_image').Get(id)\n\nexport const addToCart = (productId, quantity) => Moltin.Cart().AddProduct(productId, quantity)\n\nexport const getCartItems = id => Moltin.Cart(id).Items()\n\nexport const removeFromCart = (itemId, cartId) => Moltin.Cart(cartId).RemoveItem(itemId)\n\nexport const checkoutCart = (cartId, customer, billing) => Moltin.Cart(cartId).Checkout(customer, billing)\n\nexport const payForOrder = (orderId, token, email) => Moltin.Orders.Payment(orderId, {\n  gateway: 'stripe',\n  method: 'purchase',\n  payment: token,\n  options: {\n    receipt_email: email\n  }\n})\n\nexport const register = async ({email, password, ...rest}) => {\n  const {\n    data: { name, id }\n  } = await Moltin.Customers.Create({\n    type: 'customer',\n    email,\n    password,\n    ...rest\n  })\n  const {token} = await login({email, password})\n\n  return {\n    id,\n    name,\n    email,\n    token\n  }\n}\n\nexport const login = async ({email, password}) => {\n  const {data: {token} } = await Moltin.Customers.Token(email, password)\n\n  return {\n    token\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// lib/moltin.js","import Layout from '../components/Layout'\nimport CartItemList from '../components/CartItemList'\nimport CartSummary from '../components/CartSummary'\nimport { getCartItems, removeFromCart, checkoutCart, payForOrder } from '../lib/moltin'\n\n\n\nexport default class Cart extends React.Component {\n  state = {\n    items: [],\n    loading: true,\n    completed: false\n  }\n\n  async componentDidMount() {\n    const cartId = await localStorage.getItem('mcart')\n    const {data, meta} = await getCartItems(cartId)\n\n    this.setState({\n      items: data,\n      meta,\n      cartId,\n      loading: false\n    })\n  }\n\n_handleCheckout = async data => {\n  const cartId = await localStorage.getItem('mcart')\n\n  const {\n    id: token,\n    email,\n    card: {\n      name,\n      address_line1: line_1,\n      adress_city: city,\n      address_country: country,\n      address_state: county,\n      address_zip: postcode\n    }\n  } = data\n\n  const customer = {\n    name,\n    email\n  }\n\n  const address = {\n        first_name: name.split(' ')[0],\n        last_name: name.split(' ')[1],\n        line_1,\n        city,\n        county,\n        country,\n        postcode\n  }\n\n  try{\n    const {data: {id}} = await checkoutCart(cartId, customer, address)\n\n    await payForOrder(id, token, email)\n\n    this.setState({\n      completed: true\n    })\n  } catch (e) {\n    console.log(e);\n  }\n}\n  _handleRemoveFromCart = async itemId => {\n    const {cartId} = this.state\n    const {data, meta} = await removeFromCart(itemId, cartId)\n\n    this.setState({\n      items: data,\n      meta\n    })\n  }\n\n  render() {\n    const {meta, ...rest} = this.state\n    const {loading} = rest\n\n    return (\n      <Layout title='Cart'>\n        <CartItemList {...rest} removeFromCart={this._handleRemoveFromCart} />\n        {!loading &&\n          !rest.completed && (\n          <CartSummary {...meta} handleCheckout={this._handleCheckout} />\n        )}\n      </Layout>\n\n    )\n\n  }\n}\n\n\n// WEBPACK FOOTER //\n// pages/cart.js","module.exports = require(\"@babel/runtime/regenerator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@babel/runtime/regenerator\"\n// module id = @babel/runtime/regenerator\n// module chunks = 3 4 5 6 7","module.exports = require(\"@moltin/sdk\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@moltin/sdk\"\n// module id = @moltin/sdk\n// module chunks = 3 4 5 6 7","module.exports = require(\"next/head\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"next/head\"\n// module id = next/head\n// module chunks = 3 4 5 6 7","module.exports = require(\"next/link\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"next/link\"\n// module id = next/link\n// module chunks = 3 4 5 6 7","module.exports = require(\"next/router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"next/router\"\n// module id = next/router\n// module chunks = 3 4 5 6 7","module.exports = require(\"nprogress\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nprogress\"\n// module id = nprogress\n// module chunks = 3 4 5 6 7","module.exports = require(\"react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = react\n// module chunks = 3 4 5 6 7","module.exports = require(\"react-stripe-checkout\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react-stripe-checkout\"\n// module id = react-stripe-checkout\n// module chunks = 4","module.exports = require(\"semantic-ui-react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"semantic-ui-react\"\n// module id = semantic-ui-react\n// module chunks = 3 4 5 6 7"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;ACnEA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAGA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAJA;AAAA;AAAA;AAAA;AAAA;AATA;AAiBA;AArBA;AACA;AAsBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;;;;;;AC9CA;AACA;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAVA;AAAA;AAAA;AAAA;AAAA;AAYA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AApBA;;;;;;;;;;;;;;;;;;;;;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAJA;AAAA;AAAA;AAAA;AAAA;AAUA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAlCA;;;;;;;;;;;;;;;;;ACTA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAcA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAvBA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACJA;AAEA;AACA;AADA;AAIA;AAAA;AAAA;AAEA;AAAA;AAAA;AAEA;AAAA;AAAA;AAEA;AAAA;AAAA;AAEA;AAAA;AAAA;AAEA;AAAA;AAAA;AAEA;AAAA;AACA;AACA;AACA;AACA;AACA;AADA;AAJA;AAAA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AAHA;AACA;AAJA;AAAA;AAAA;AAEA;AAAA;AAFA;AAAA;AASA;AAAA;AAAA;AACA;AAVA;AAAA;AASA;AATA;AAYA;AACA;AACA;AACA;AAJA;AACA;AAZA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAmBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAIA;AADA;AACA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9CA;AACA;AACA;AACA;AACA;AAGA;;;;;;;;;;;;;;;;;;;;AACA;AACA;AACA;AACA;AAHA;;;;;;;;AAkBA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AAGA;AAYA;AACA;AACA;AAFA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AArBA;AAAA;AAAA;AACA;AADA;AAAA;AAgCA;AAhCA;AAAA;AACA;AADA;AAoCA;AACA;AADA;AACA;AArCA;AAAA;AACA;AADA;AAAA;AAAA;AAwCA;AACA;AAzCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;;AA0CA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAEA;AAAA;AACA;AACA;AACA;AACA;AAFA;AACA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;;;;;;;;;;;AAvDA;AACA;;AADA;;AACA;AACA;;;AADA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAJA;AACA;;;;;;;;;;;;;;;AA4DA;AAAA;AAAA;AAAA;AACA;AADA;AAIA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;;;;AAvFA;AACA;;;;;;;;;;;;;;;;ACRA;;;;;;;ACAA;;;;;;;ACAA;;;;;;;ACAA;;;;;;;ACAA;;;;;;;ACAA;;;;;;;ACAA;;;;;;;ACAA;;;;;;;ACAA;;;;A","sourceRoot":""}