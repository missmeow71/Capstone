{"version":3,"file":"bundles/pages/cart.js","sources":["webpack:///webpack/bootstrap e41cbeb48cdea8fb9652","webpack:///components/CartItemList.js","webpack:///components/CartSummary.js","webpack:///lib/moltin.js","webpack:///pages/cart.js","webpack:///external \"@babel/runtime/regenerator\"","webpack:///external \"@moltin/sdk\"","webpack:///external \"next/link\"","webpack:///external \"react\"","webpack:///external \"semantic-ui-react\""],"sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tvar threw = true;\n \t\ttry {\n \t\t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n \t\t\tthrew = false;\n \t\t} finally {\n \t\t\tif(threw) delete installedModules[moduleId];\n \t\t}\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap e41cbeb48cdea8fb9652","import Link from 'next/link'\nimport {Item, Loader, Button, Message} from 'semantic-ui-react'\n\nexport default ({items, removeFromCart, loading, completed}) => {\n  if (loading) return <Loader active inline ='centered' />\n\n  if (completed)\n      return (\n        <Message success>\n          <Message.Header>Order Placed!</Message.Header>\n          <p>Congratulations! Your order is on its way</p>\n        </Message>\n      )\n\n  if (items.length === 0) {\n    return (\n      <Message warning>\n        <Message.Header>Your cart is empty!</Message.Header>\n        <p>Please add some items to your cart before resuming checkout.</p>\n      </Message>\n    )\n  }\n  const mapCartItemsToItems = items =>\n  items.map(({id, product_id, name, quantity, meta}) => {\n    const price = meta.display_price.with_tax.unit.formatted || null\n\n    return {\n      childKey: id,\n      header: (\n        <Link href={`/product?id=${product_id}`} passHref>\n          <Item.Header as=\"a\">{name}</Item.Header>\n        </Link>\n      ),\n      meta: `${quantity}x ${price}`,\n      extra: (\n        <Button\n          basic\n          icon='remove'\n          floated='right'\n          onClick={() => removeFromCart(id)}\n        />\n      )\n    }\n  })\n\n  return <Item.Group divided items={mapCartItemsToItems(items)} />\n}\n\n\n// WEBPACK FOOTER //\n// components/CartItemList.js","import StripeCheckout from 'react-stripe-checkout'\nimport {Button, Segment, Divider} from 'semantic-ui-react'\n\nexport default ({\n    display_price: {with_tax: {currency, amount, formatted}}}) => (\n        <React.Fragment>\n            <Divider />\n\n            <Segment clearing size='large'>\n            <strong>Sub Total:</strong> {formatted}\n            <Button color='black' floated='right'>\n          Check Out\n        </Button>\n            </Segment>\n        </React.Fragment>\n    )\n\n\n// WEBPACK FOOTER //\n// components/CartSummary.js","import { gateway as MoltinGateway } from '@moltin/sdk'\n\nconst Moltin = MoltinGateway({\n    client_id: 'TkrDPNqfC1j7AJFFUHnMZbN9RzPygkff3beqMhxQsl'\n})\n\nexport const getProducts = () => Moltin.Products.With('main_image').All()\n\nexport const getProductById = id => Moltin.Products.With('main_image').Get(id)\n\nexport const addToCart = (productId, quantity) => Moltin.Cart().AddProduct(productId, quantity)\n\nexport const getCartItems = id => Moltin.Cart(id).Items()\n\nexport const removeFromCart = (itemId, cartId) => Moltin.Cart(cartId).RemoveItem(itemId)\n\n\n\n\n// WEBPACK FOOTER //\n// lib/moltin.js","import Layout from '../components/layout'\nimport CartItemList from '../components/CartItemList'\nimport CartSummary from '../components/CartSummary'\nimport { getCartItems, removeFromCart, checkoutCart, payForOrder } from '../lib/moltin'\n\n\n\nexport default class Cart extends React.Component {\n  state = {\n    items: [],\n    loading: true,\n    completed: false\n  }\n\n  async componentDidMount() {\n    const cartId = await localStorage.getItem('mcart')\n    const {data, meta} = await getCartItems(cartId)\n\n    this.setState({\n      items: data,\n      meta,\n      cartId,\n      loading: false\n    })\n  }\n\n_handleCheckout = async data => {\n  const cartId = await localStorage.getItem('mcart')\n\n  const {\n    id: token,\n    email,\n    card: {\n      name,\n      address_line1: line_1,\n      adress_city: city,\n      address_country: country,\n      address_state: county,\n      address_zip: postcode\n    }\n  } = data\n\n  const customer = {\n    name,\n    email\n  }\n\n  const address = {\n        first_name: name.split(' ')[0],\n        last_name: name.split(' ')[1],\n        line_1,\n        city,\n        county,\n        country,\n        postcode\n  }\n\n  try{\n    const {data: {id}} = await checkoutCart(cartId, customer, address)\n\n    await payForOrder(id, token, email)\n\n    this.setState({\n      completed: true\n    })\n  } catch (e) {\n    console.log(e);\n  }\n}\n  _handleRemoveFromCart = async itemId => {\n    const {cartId} = this.state\n    const {data, meta} = await removeFromCart(itemId, cartId)\n\n    this.setState({\n      items: data,\n      meta\n    })\n  }\n\n  render() {\n    const {meta, ...rest} = this.state\n    const {loading} = rest\n\n    return (\n      <Layout title='Cart'>\n        <CartItemList {...rest} removeFromCart={this._handleRemoveFromCart} />\n        {!loading &&\n          !rest.completed && (\n          <CartSummary {...meta} handleCheckout={this._handleCheckout} />\n        )}\n      </Layout>\n\n    )\n\n  }\n}\n\n\n// WEBPACK FOOTER //\n// pages/cart.js","module.exports = require(\"@babel/runtime/regenerator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@babel/runtime/regenerator\"\n// module id = @babel/runtime/regenerator\n// module chunks = 4 5","module.exports = require(\"@moltin/sdk\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@moltin/sdk\"\n// module id = @moltin/sdk\n// module chunks = 4 5","module.exports = require(\"next/link\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"next/link\"\n// module id = next/link\n// module chunks = 4 5","module.exports = require(\"react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"react\"\n// module id = react\n// module chunks = 4 5","module.exports = require(\"semantic-ui-react\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"semantic-ui-react\"\n// module id = semantic-ui-react\n// module chunks = 4 5"],"mappings":"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","sourceRoot":""}